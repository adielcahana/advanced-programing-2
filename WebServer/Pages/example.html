<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
	<title>little example</title>
    <script src="../Scripts/jquery-3.1.1.js"></script>
    <script>
        var board;
        function startGame() {
            var name = $("Name").val();
            var rows = $("Rows").val();
            var cols = $("Cols").val();
            var apiUrl = 'api/SinglePlayerController/' + name + "/" + rows + "/" + cols;
            $.getJSON(apiUrl).done(function(data) {
                var rows = data["Rows"];
                var cols = data["Cols"];
                var maze = [];
                var row = [];
                var i = 0;
                forEach(data["Maze"],
                    function(item, index) {
                        if (i != cols) {
                            row[i] = parseInt(item);
                            i++;
                        } else {
                            maze.push(row);
                            row = [];
                            i = 0;
                        }
                    });
                board = $("#mazeCanvas").mazeBoard(maze,
                    data["Start"]["Row"],
                    data["Start"]["Col"],
                    data["End"]["Row"],
                    data["End"]["Col"],
                    player_right,
                    player_left,
                    exit,
                    wall,
                    true);
                exit.onload = function() {
                    board.drawMaze();
                }
                wall.onload = function() {
                    board.drawMaze();
                }
                player_left.onload = function() {
                    board.drawMaze();
                }
                player_right.onload = function() {
                    board.drawMaze();
                }
                document.onkeydown = function(e) {
                    switch (e.which) {
                    case 37:
                        board.makeMove("left");
                        break;
                    case 38:
                        board.makeMove("up");
                        break;
                    case 39:
                        board.makeMove("right");
                        break;
                    case 40:
                        board.makeMove("down");
                        break;
                    default:
                        break;
                    }
                }
            });
        }
    </script>
</head>
<body>
<button id="solve">solve</button>
<canvas id="mazeCanvas" width="300" height="300" style="border: 2px black solid"></canvas>
<div style="margin: 0px 15% 0px 45%">
    <h1> Single Game </h1>
    <table>
        <tr><td>Name: </td>
            <td><input id="Name" type="text" name="Name" style="width: 50px" value="0" /></td></tr>
        <tr><td>Rows size: </td>
            <td><input id="Rows" type="text" name="Rows" style="width: 50px" value="0" /></td></tr>
        <tr><td>Cols size: </td>
            <td><input id="Cols" type="text" name="Cols" style="width: 50px" value="0" /></td></tr>
    </table>
    <input type="button" id="Stat Game" value="Start New Game" onclick="startGame" />
</div>
<script src="../Scripts/jquery.mazeBoard.js"></script>
<script>
    exit = new Image();
    player_left = new Image();
    player_right = new Image();
    wall = new Image();
    exit.src = "../images/goal.png";
    player_left.src = '../images/dave_left.png';
    player_right.src = '../images/dave_right.png';
    wall.src = '../images/wall.png';
//    var maze = [
//        [0, 1, 0, 1, 0, 1, 0, 0, 1, 1], [0, 1, 0, 1, 0, 1, 0, 0, 1, 1], [0, 1, 0, 1, 0, 1, 0, 0, 1, 1],
//        [0, 1, 0, 1, 0, 1, 0, 0, 1, 1], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 1, 0, 1, 0, 1, 0, 0, 1, 1],
//        [0, 1, 0, 1, 0, 1, 0, 0, 1, 1], [0, 1, 0, 1, 0, 1, 0, 0, 1, 1], [0, 1, 0, 1, 0, 1, 0, 0, 1, 1],
//        [0, 1, 0, 1, 0, 1, 0, 0, 1, 1]
//    ];

    $("#solve")[0].onclick = function() {
        board.solve(board, [3, 3, 3, 3, 1, 1, 1, 1, 1, 1, 1, 3, 3, 3, 3, 3]);
    }
/*	function sleep(time) {
		return new Promise((resolve) => setTimeout(resolve, time));
	}

	sleep(1000).then(() => {
		board.solve([3, 3, 3, 3, 1, 1, 1, 1, 1, 1, 1, 3, 3, 3, 3, 3]);
	});*/
</script>
</body>
</html>