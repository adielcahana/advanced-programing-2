<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Single Player</title>
    <script src="../Scripts/jquery-3.1.1.js"></script>
    <link href="../Styles/GamesStyle.css" rel="stylesheet" />
    <script src="../Scripts/jquery-3.1.1.js"></script>
    <script>
        var board;
        exit = new Image();
        player_left = new Image();
        player_right = new Image();
        wall = new Image();
        exit.src = "../images/goal.png";
        player_left.src = '../images/dave_left.png';
        player_right.src = '../images/dave_right.png';
        wall.src = '../images/wall.png';
        function startGame() {
            var name = $("#Name").val();
            var rows = $("#Rows").val();
            var cols = $("#Cols").val();
            var apiUrl = '/api/SinglePlayer';
            $.ajax({
                method: "GET",
                url: apiUrl
//                data: { "name": name, "row": rows, "col": cols }
            }).done(function (data) {
                var cols = data["Cols"];
                var maze = [];
                var row = [];
                var i = 0;
                var mazeSrl = data["Maze"];
                for(var c of mazeSrl) {
                    if (i < cols) {
                        row[i] = parseInt(c);
                        i++;
                    } else {
                        maze.push(row);
                        row = [parseInt(c)];
                        i = 1;
                    }
                };
                maze.push(row);
                board = $("#mazeCanvas").mazeBoard(maze,
                    data["Start"]["Row"],
                    data["Start"]["Col"],
                    data["End"]["Row"],
                    data["End"]["Col"],
                    player_right,
                    player_left,
                    exit,
                    wall,
                    true);
//                exit.onload = function () {
//                    board.drawMaze();
//                }
//                player_left.onload = function () {
//                    board.drawMaze();
//                }
//                player_right.onload = function () {
//                    board.drawMaze();
//                }
//                wall.onload = function () {
//                    board.drawMaze();
//                }
                document.onkeydown = function (e) {
                    switch (e.which) {
                    case 37:
                        board.makeMove("left");
                        break;
                    case 38:
                        board.makeMove("up");
                        break;
                    case 39:
                        board.makeMove("right");
                        break;
                    case 40:
                        board.makeMove("down");
                        break;
                    default:
                        break;
                    }
                }
                board.drawMaze();
            });
        }
    </script>
</head>
<body>
<iframe src="Navigation.html" scrolling="no" frameborder="0"></iframe>
<div style="margin: 0px 0px 0px 5%">
    <h1> SinglePlayer Game </h1>
    <table>
        <tr>
            <td>Name: </td>
            <td><input id="Name" type="text" name="Name" style="width: 50px" value="0"/></td>
        </tr>
        <tr>
            <td>Rows size: </td>
            <td><input id="Rows" type="text" name="Rows" style="width: 50px" value="0"/></td>
        </tr>
        <tr>
            <td>Cols size: </td>
            <td><input id="Cols" type="text" name="Cols" style="width: 50px" value="0"/></td>
        </tr>
        <tr>
            <td><input type="button" id="start" value="Start New Game"/></td>
        </tr>
        <tr>
            <td>Search Algorithm: </td>
            <td>
                <select id="Algorithm">
                    <option value="BFS">BFS</option>
                    <option value="DFS">DFS</option>
                </select>
            </td>
        </tr>
        <tr>
            <td><input id="solve" type="button" style="width:100px" value="Solve" /></td>
        </tr>
    </table>
    <canvas class="maze" id="mazeCanvas" style="border: 2px black solid"></canvas>
</div>
<script src="../Scripts/jquery.SinglePlayerScript.js"></script>
<script src="../Scripts/jquery.mazeBoard.js"></script>
<script>
    $("#start")[0].onclick = startGame;
    $("#solve")[0].onclick = function() {
        board.solve(board, [3, 3, 3, 3, 1, 1, 1, 1, 1, 1, 1, 3, 3, 3, 3, 3]);
    }
</script>
</body>
</html>
